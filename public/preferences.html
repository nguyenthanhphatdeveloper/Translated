<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T√πy ch·ªçn h·ªçc t·∫≠p</title>
  <script>
    (function() {
      if (typeof console !== 'undefined' && console.warn) {
        const originalWarn = console.warn;
        console.warn = function(...args) {
          const firstArg = args[0];
          if (typeof firstArg === 'string' && (
            firstArg.includes('cdn.tailwindcss.com should not be used') ||
            firstArg.includes('tailwindcss.com should not be used')
          )) {
            return;
          }
          originalWarn.apply(console, args);
        };
      }
    })();
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen">
  <nav class="bg-white shadow-sm border-b">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <a href="/" class="text-xl font-bold text-purple-600">üìö English Vocab</a>
        <div class="flex items-center space-x-4 text-sm">
          <a href="/learn" class="text-gray-700 hover:text-purple-600">H·ªçc t·ª´</a>
          <a href="/assessment" class="text-gray-700 hover:text-purple-600">Test Level</a>
          <a href="/ipa" class="text-gray-700 hover:text-purple-600">IPA</a>
          <a href="/preferences" class="text-purple-600 font-semibold">T√πy ch·ªçn</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-6">‚öôÔ∏è T√πy ch·ªçn h·ªçc t·∫≠p</h1>

    <div id="preferencesForm" class="bg-white rounded-lg shadow p-6 space-y-6">
      <!-- Topics -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Topics y√™u th√≠ch</label>
        <select id="preferredTopics" multiple class="w-full px-3 py-2 border rounded-lg">
          <option value="Food & Drink">Food & Drink</option>
          <option value="Travel">Travel</option>
          <option value="Work">Work</option>
          <option value="Health">Health</option>
          <option value="Education">Education</option>
          <option value="Technology">Technology</option>
          <option value="Sports">Sports</option>
          <option value="Entertainment">Entertainment</option>
        </select>
        <p class="text-xs text-gray-500 mt-1">Gi·ªØ Ctrl/Cmd ƒë·ªÉ ch·ªçn nhi·ªÅu</p>
      </div>

      <!-- Levels -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Levels y√™u th√≠ch</label>
        <div class="flex flex-wrap gap-2">
          <label class="flex items-center"><input type="checkbox" value="A1" class="mr-1"> A1</label>
          <label class="flex items-center"><input type="checkbox" value="A2" class="mr-1"> A2</label>
          <label class="flex items-center"><input type="checkbox" value="B1" class="mr-1"> B1</label>
          <label class="flex items-center"><input type="checkbox" value="B2" class="mr-1"> B2</label>
          <label class="flex items-center"><input type="checkbox" value="C1" class="mr-1"> C1</label>
          <label class="flex items-center"><input type="checkbox" value="C2" class="mr-1"> C2</label>
        </div>
      </div>

      <!-- Difficulty -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·ªô kh√≥</label>
        <select id="difficulty" class="w-full px-3 py-2 border rounded-lg">
          <option value="easy">D·ªÖ</option>
          <option value="medium">V·ª´a</option>
          <option value="hard">Kh√≥</option>
          <option value="adaptive">T·ª± ƒë·ªông (khuy·∫øn ngh·ªã)</option>
        </select>
      </div>

      <!-- Daily Goal -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">M·ª•c ti√™u h√†ng ng√†y</label>
        <div class="flex items-center gap-2">
          <input type="number" id="dailyGoal" min="10" max="200" class="w-24 px-3 py-2 border rounded-lg">
          <span>t·ª´/ng√†y</span>
        </div>
      </div>

      <!-- Options -->
      <div class="space-y-3">
        <label class="flex items-center">
          <input type="checkbox" id="showHints" class="mr-2">
          <span>Hi·ªÉn th·ªã g·ª£i √Ω</span>
        </label>
        <label class="flex items-center">
          <input type="checkbox" id="autoPlayAudio" class="mr-2">
          <span>T·ª± ƒë·ªông ph√°t audio</span>
        </label>
        <label class="flex items-center">
          <input type="checkbox" id="showTranslation" class="mr-2">
          <span>Hi·ªÉn th·ªã b·∫£n d·ªãch</span>
        </label>
        <label class="flex items-center">
          <input type="checkbox" id="adaptiveLearning" class="mr-2">
          <span>H·ªçc t·∫≠p th√≠ch ·ª©ng (t·ª± ƒë·ªông ƒëi·ªÅu ch·ªânh ƒë·ªô kh√≥)</span>
        </label>
        <label class="flex items-center">
          <input type="checkbox" id="focusWeakAreas" class="mr-2">
          <span>T·∫≠p trung v√†o ƒëi·ªÉm y·∫øu</span>
        </label>
      </div>

      <!-- Buttons -->
      <div class="flex gap-3 pt-4">
        <button onclick="savePreferences()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
          <i class="fas fa-save mr-2"></i> L∆∞u
        </button>
        <button onclick="resetPreferences()" class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200">
          <i class="fas fa-undo mr-2"></i> ƒê·∫∑t l·∫°i m·∫∑c ƒë·ªãnh
        </button>
      </div>

      <div id="saveMessage" class="hidden text-green-600 text-sm"></div>
    </div>
  </main>

  <script src="/js/preferences.js"></script>
  <script>
    const preferences = new LearningPreferences();

    // Load v√† hi·ªÉn th·ªã preferences
    function loadPreferences() {
      const prefs = preferences.preferences;

      // Topics
      const topicsSelect = document.getElementById('preferredTopics');
      Array.from(topicsSelect.options).forEach(opt => {
        opt.selected = prefs.preferredTopics.includes(opt.value);
      });

      // Levels
      document.querySelectorAll('input[type="checkbox"][value^="A"], input[type="checkbox"][value^="B"], input[type="checkbox"][value^="C"]').forEach(cb => {
        cb.checked = prefs.preferredLevels.includes(cb.value);
      });

      // Difficulty
      document.getElementById('difficulty').value = prefs.difficulty;

      // Daily Goal
      document.getElementById('dailyGoal').value = prefs.dailyGoal;

      // Options
      document.getElementById('showHints').checked = prefs.showHints;
      document.getElementById('autoPlayAudio').checked = prefs.autoPlayAudio;
      document.getElementById('showTranslation').checked = prefs.showTranslation;
      document.getElementById('adaptiveLearning').checked = prefs.adaptiveLearning;
      document.getElementById('focusWeakAreas').checked = prefs.focusWeakAreas;
    }

    // Save preferences
    function savePreferences() {
      const topicsSelect = document.getElementById('preferredTopics');
      const selectedTopics = Array.from(topicsSelect.selectedOptions).map(opt => opt.value);
      
      const selectedLevels = Array.from(document.querySelectorAll('input[type="checkbox"][value^="A"], input[type="checkbox"][value^="B"], input[type="checkbox"][value^="C"]:checked')).map(cb => cb.value);

      const updates = {
        preferredTopics: selectedTopics,
        preferredLevels: selectedLevels,
        difficulty: document.getElementById('difficulty').value,
        dailyGoal: parseInt(document.getElementById('dailyGoal').value),
        showHints: document.getElementById('showHints').checked,
        autoPlayAudio: document.getElementById('autoPlayAudio').checked,
        showTranslation: document.getElementById('showTranslation').checked,
        adaptiveLearning: document.getElementById('adaptiveLearning').checked,
        focusWeakAreas: document.getElementById('focusWeakAreas').checked
      };

      preferences.updatePreferences(updates);

      const msg = document.getElementById('saveMessage');
      msg.textContent = '‚úì ƒê√£ l∆∞u t√πy ch·ªçn!';
      msg.classList.remove('hidden');
      setTimeout(() => msg.classList.add('hidden'), 3000);
    }

    // Reset preferences
    function resetPreferences() {
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ t√πy ch·ªçn v·ªÅ m·∫∑c ƒë·ªãnh?')) {
        preferences.reset();
        loadPreferences();
        const msg = document.getElementById('saveMessage');
        msg.textContent = '‚úì ƒê√£ ƒë·∫∑t l·∫°i m·∫∑c ƒë·ªãnh!';
        msg.classList.remove('hidden');
        setTimeout(() => msg.classList.add('hidden'), 3000);
      }
    }

    // Load on page load
    window.addEventListener('DOMContentLoaded', loadPreferences);
  </script>
</body>
</html>

